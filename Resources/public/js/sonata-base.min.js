jQuery(document).ready(function(){jQuery("html").removeClass("no-js");Admin.add_pretty_errors(document);Admin.add_filters(document);Admin.set_object_field_value(document);Admin.setup_collection_buttons(document);Admin.setup_per_page_switcher(document);Admin.setup_form_tabs_for_errors(document)});
var Admin={log:function(){},add_pretty_errors:function(a){jQuery("div.sonata-ba-field-error",a).each(function(b,d){var c=jQuery("input, textarea, select",d),e=jQuery("div.sonata-ba-field-error-messages",d).html();jQuery("div.sonata-ba-field-error-messages",d).html("");e||(e="");if(e.length!=0){if(jQuery(c).is("select")){c.wrap("<span></span>");c=c.parent()}else c=c;c.qtip({content:e,show:"focusin",hide:"focusout",position:{corner:{target:"rightMiddle",tooltip:"leftMiddle"}},style:{name:"red",border:{radius:2},
tip:"leftMiddle"}})}})},stopEvent:function(a){if(a.preventDefault)a.preventDefault();else a.returnValue=false;return targetElement=typeof a.target!="undefined"?a.target:a.srcElement},add_filters:function(){jQuery(".admin-ajax-ignore-event").on("click",function(a){a.preventDefault();a.stopPropagation();jQuery(".admin-filter-ajax").collapse("toggle")})},set_object_field_value:function(a){this.log(jQuery("a.sonata-ba-edit-inline",a));jQuery("a.sonata-ba-edit-inline",a).click(function(b){Admin.stopEvent(b);
var d=jQuery(this);jQuery.ajax({url:d.attr("href"),type:"POST",success:function(c){if(c.status==="OK"){var e=jQuery(d).parent();e.children().remove();e.html(jQuery(c.content.replace(/<!--[\s\S]*?--\>/g,"")).html());e.effect("highlight",{color:"#57A957"},2E3);Admin.set_object_field_value(e)}else jQuery(d).parent().effect("highlight",{color:"#C43C35"},2E3)}})})},setup_collection_buttons:function(a){jQuery(a).on("click",".sonata-collection-add",function(b){Admin.stopEvent(b);b=jQuery(this).closest("[data-prototype]");
var d=b.attr("data-prototype"),c=RegExp(b.attr("id")+"___name__","g");d=d.replace(c,b.attr("id")+"_"+(b.children().length-1));c=b.attr("id").split("_");d=d.replace(RegExp(c[c.length-1]+"\\]\\[__name__","g"),c[c.length-1]+"]["+(b.children().length-1));jQuery(d).insertBefore(jQuery(this).parent());jQuery(this).trigger("sonata-collection-item-added")});jQuery(a).on("click",".sonata-collection-delete",function(b){Admin.stopEvent(b);jQuery(this).closest(".sonata-collection-row").remove();jQuery(this).trigger("sonata-collection-item-deleted")})},
setup_per_page_switcher:function(){jQuery("select.per-page").change(function(){jQuery("input[type=submit]").hide();window.top.location.href=this.options[this.selectedIndex].value})},setup_form_tabs_for_errors:function(a){jQuery("form",a).each(function(){Admin.show_form_first_tab_with_errors(jQuery(this),".sonata-ba-field-error")});jQuery(a).on("click",'form [type="submit"]',function(){Admin.show_form_first_tab_with_errors(jQuery(this).closest("form"),":invalid")}).on("keypress",'form [type="text"]',
function(b){13===b.which&&Admin.show_form_first_tab_with_errors(jQuery(this),":invalid")})},show_form_first_tab_with_errors:function(a,b){var d;a.find(".nav-tabs a").each(function(){var c=jQuery(this).attr("href"),e=jQuery(this),f=e.find(".has-errors");if(jQuery(c).find(b).length>0){if(!d){e.tab("show");d=e}f.removeClass("hide")}else f.addClass("hide")})},loadingMessage:function(a){a=a?a:"Please wait while we process your request.";return'<div id="gritter-notice-wrapper-blockui-loading"><div id="gritter-item-blockui-loading" class="gritter-item-wrapper gritter-primary" style=""><div class="gritter-top"></div><div class="gritter-item"><div class="gritter-close" style="display: none;"></div><div class="gritter-without-image"><span class="gritter-title"><i class="icon-spinner"></i> Processing...</span><p>'+
a+'</p></div><div style="clear:both"></div></div><div class="gritter-bottom"></div></div></div>'},initElements:function(a){jQuery('[class*="selectpicker"]',a).selectpicker();jQuery('[class*="uni_style"]',a).uniform();jQuery('[class="footable"]',a).footable();a.find(".chzn-select").chosen({allow_single_deselect:true});a.find(".chzn-select-multiple").chosen().change(function(){$(this).find(".chzn-choices").each(function(){console.log(this);console.log("child")})});a.find(".rz-datepicker").datepicker({autoclose:true});
a.find(".rz-timepicker").timepicker({defaultTime:false,showMeridian:false});a.find(".rz-datetimepicker").datetimepicker({autoclose:true,todayBtn:true,pickerPosition:"bottom-left",minuteStep:5});jQuery(".datepicker.dropdown-menu").css("z-index",9999);jQuery(".rz_grid ul",a).imagesLoaded(jQuery.proxy(function(){var b={autoResize:true,container:$(".rz_grid"),offset:5,itemWidth:220,flexibleItemWidth:false};jQuery(".rz_grid ul li",a).wookmark(b);jQuery(".rz_grid ul li").on("mouseenter",function(){$(this).addClass("act_tools")}).on("mouseleave",
function(){$(this).removeClass("act_tools")})},a))}};
